databaseChangeLog:
  - changeSet:
      id: "003-ensure-template-versioning-schema"
      author: "blocpress"
      comment: "Ensure template table has proper versioning schema (UC-10.1)"
      # This changeset is idempotent - safe to run even if schema already exists
      changes:
        - sql:
            sql: |
              -- Ensure proper indexes exist for versioning queries
              CREATE INDEX IF NOT EXISTS idx_template_name_version
                ON template(name, version DESC);

              CREATE INDEX IF NOT EXISTS idx_template_status_valid_from
                ON template(status, valid_from DESC NULLS FIRST);
            dbms: postgresql
            comment: "Create performance indexes for template versioning queries"
